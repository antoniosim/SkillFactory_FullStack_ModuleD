from news.models import User,Author,Post,Category,PostCategory,Comment
from django.db.models import Sum
User.objects.all().delete()
Author.objects.all().delete()
Post.objects.all().delete()
Category.objects.all().delete()
PostCategory.objects.all().delete()
Comment.objects.all().delete()
user1=User.objects.create_user('user1','user1@mail.ru','123123123')
user2=User.objects.create_user('user2','user2@mail.ru','321321321')
user3=User.objects.create_user('user3','user3@mail.ru','111222333')
author1=Author.objects.create(userID=user1)
author2=Author.objects.create(userID=user2)
category1=Category.objects.create(title='category1')
category2=Category.objects.create(title='category2')
category3=Category.objects.create(title='category3')
category4=Category.objects.create(title='category4')
article1=Post.objects.create(authorID=author1,type='AR',heading='article1',content='content1')
article2=Post.objects.create(authorID=author2,type='AR',heading='article2',content='content2')
news1=Post.objects.create(authorID=author1,type='NW',heading='news1',content='content3')
newcategory=PostCategory.objects.create(postID=article1,categoryID=category1)
newcategory=PostCategory.objects.create(postID=article1,categoryID=category2)
newcategory=PostCategory.objects.create(postID=article2,categoryID=category3)
newcategory=PostCategory.objects.create(postID=news1,categoryID=category4)
comment1=Comment.objects.create(userID=user1,postID=article1,content='comment11')
comment2=Comment.objects.create(userID=user2,postID=article1,content='comment12')
comment3=Comment.objects.create(userID=user3,postID=article2,content='comment21')
comment4=Comment.objects.create(userID=user1,postID=article2,content='comment22')
comment5=Comment.objects.create(userID=user3,postID=news1,content='comment3')
article1.like()
article1.like()
article2.dislike()
news1.like()
news1.like()
news1.dislike()
comment1.like()
comment1.like()
comment2.like()
comment2.like()
comment2.like()
comment3.dislike()
comment4.dislike()
comment4.dislike()
comment5.like()
author1.update_rating()
author2.update_rating()
best_author = Author.objects.order_by("-rating")[0]
print(f'Лучший автор: {best_author.userID.username}, рейтинг: {best_author.rating}')
best_article = Post.objects.order_by("-rating")[0]
print('')
print(f'Лучшая статья: "{best_article.heading}" [Рейтинг: {best_article.rating}]\n'
      f'{best_article.createdAt.strftime("%d.%m.%Y %H:%M:%S")} [Автор: {best_article.authorID.userID.username}]\n'
      f'{best_article.preview()}')
for comt in best_article.postcomments.all():
    print(f'{comt.createdAt.strftime("%d.%m.%Y %H:%M:%S")} [Автор: {comt.userID.username}]\n'
          f'{comt.content}\n'
          f'Рейтинг: {comt.rating}')